# Лабораторна робота №3: Конструктори, деструктори, статичні елементи

## Опис проекту

Розширення системи управління періодичними виданнями з демонстрацією конструкторів, деструкторів, статичних елементів та дружніх функцій.

## Виконання вимог завдання

### ✅ Пункт 1: Визначення конструкторів

**Клас Publication (файл: `Publication.h`, `publications.cpp`):**

1. **Конструктор без параметрів** (рядок 22 в .h, рядки 10-18 в .cpp)

   ```cpp
   Publication();
   ```

   - Ініціалізує всі поля значеннями за замовчуванням
   - Збільшує статичний лічильник `total_publications_count_`

2. **Конструктор з параметрами** (рядки 23-24 в .h, рядки 20-35 в .cpp)

   ```cpp
   Publication(int id, const std::string& title, const std::string& description,
               double price, const std::string& category, int pages);
   ```

   - Ініціалізує всі поля переданими значеннями
   - Збільшує статичний лічильник

3. **Конструктор копіювання** (рядок 25 в .h, рядки 37-47 в .cpp)
   ```cpp
   Publication(const Publication& other);
   ```
   - Створює повну копію об'єкта
   - Копіює всі 8 полів
   - Збільшує статичний лічильник

**Клас Client (файл: `Client.h`, `clients.cpp`):**

1. **Конструктор без параметрів** (рядок 19 в .h, рядки 10-18 в .cpp)

   - Ініціалізує всі 9 полів, включаючи вкладений об'єкт `Publication`

2. **Конструктор з параметрами** (рядки 20-21 в .h, рядки 20-35 в .cpp)

   - Ініціалізує поля клієнта
   - Викликає конструктор без параметрів для `subscribed_publication_`

3. **Конструктор копіювання** (рядок 22 в .h, рядки 37-57 в .cpp)
   ```cpp
   Client(const Client& other);
   ```
   - Створює глибоку копію клієнта
   - Копіює вкладений об'єкт `Publication` (не покажчик!)

---

### ✅ Пункт 2: Конструктори зі списком ініціалізації

**Publication (рядки 27-28 в .h, рядки 49-66 в .cpp):**

```cpp
Publication(int id, const std::string& title, double price)
    : id_(id),                    // Ініціалізація через список
      title_(title),              // Ініціалізація через список
      description_("Без опису"),  // Константне початкове значення
      price_(price),
      category_("Загальна"),      // Константне початкове значення
      rating_(0.0),
      review_count_(0),
      pages_(0)
```

**Демонстрація:**

- Усі конструктори використовують список ініціалізації
- Показано задання початкових значень констант ("Без опису", "Загальна")
- Поля ініціалізуються в порядку їх оголошення в класі

**Client (рядки 24-25 в .h, рядки 59-75 в .cpp):**

```cpp
Client(int id, const std::string& first_name, const std::string& last_name)
    : client_id_(id),
      first_name_(first_name),
      last_name_(last_name),
      email_("no-email@example.com"),  // Константне значення
      phone_("+380000000000"),         // Константне значення
      is_blacklisted_(false),
      balance_(0.0),
      subscription_months_(0),
      subscribed_publication_()        // Викликається конструктор Publication()
```

---

### ✅ Пункт 3: Статичні елементи

**Статичні поля даних (спільне використання між об'єктами):**

**Publication (рядок 15 в .h, рядок 9 в .cpp):**

```cpp
// Оголошення в класі
private:
  static int total_publications_count_;

// Ініціалізація поза класом
int Publication::total_publications_count_ = 0;
```

**Client (рядок 16 в .h, рядок 9 в .cpp):**

```cpp
private:
  static int total_clients_count_;

// Ініціалізація поза класом
int Client::total_clients_count_ = 0;
```

**Статичні методи:**

**Publication (рядки 56-57 в .h, рядки 243-252 в .cpp):**

```cpp
static int GetTotalPublicationsCount();  // Отримати лічильник
static void ResetPublicationsCount();    // Скинути лічильник
```

**Client (рядки 59-60 в .h, рядки 288-297 в .cpp):**

```cpp
static int GetTotalClientsCount();       // Отримати лічильник
static void ResetClientsCount();         // Скинути лічильник
```

**Використання в main():**

- Виклик статичних методів БЕЗ створення об'єктів (рядки 157-160 в main_lab3.cpp)
- Автоматичне збільшення лічильника при створенні об'єктів
- Автоматичне зменшення при знищенні об'єктів
- Демонстрація в функції `DemonstrateStaticMembers()` (рядки 148-196)

---

### ✅ Пункт 4: Функції поза межами класу

**Функція для Publication (рядки 17-39 в main_lab3.cpp):**

```cpp
void CalculatePublicationStatistics(const Publication& pub) {
  // Приймає об'єкт класу як параметр
  // Обчислює:
  // - Річну вартість (price * 12)
  // - Ціну за сторінку (price / pages)
  // - Середній рейтинг
  // Виводить результати на екран
}
```

**Функція для Client (рядки 41-63 в main_lab3.cpp):**

```cpp
void CalculateClientExpenses(const Client& client) {
  // Приймає об'єкт класу Client
  // Обчислює витрати на підписку
  // Виводить інформацію про платежі
}
```

**Виклик в main():**

- Рядки 214-215: викликаються з об'єктами як параметрами
- Функції працюють з числовими даними класів
- Результати обчислень виводяться на екран

---

### ✅ Пункт 5: Функції, що повертають об'єкти

**Функція для Publication (рядки 65-83 в main_lab3.cpp):**

```cpp
Publication CreateDiscountedPublication(const Publication& original,
                                        double discount_percent) {
  // Створює копію через конструктор копіювання
  Publication discounted = original;

  // Оперує методами класу
  discounted.SetPrice(original.GetPrice(), discount_percent);

  // Повертає об'єкт класу
  return discounted;
}
```

**Функція для Client (рядки 85-101 в main_lab3.cpp):**

```cpp
Client CreateVIPClient(const Client& regular_client, double bonus_balance) {
  // Використовує конструктор копіювання
  Client vip_client = regular_client;

  // Оперує методами класу (перевантажений метод)
  vip_client.AddBalance(0, bonus_balance);

  // Повертає об'єкт класу
  return vip_client;
}
```

**Демонстрація в main():**

- Рядки 226-234: виклик функцій та отримання об'єктів
- Повернені об'єкти працюють коректно (виклик методів)

---

### ✅ Пункт 6: Покажчики та пам'ять

**Демонстрація в функції `DemonstratePointersAndArrays()` (рядки 236-306):**

**Статичні об'єкти (рядки 245-246):**

```cpp
Publication static_pub(40, "Статичне видання", "Опис", 150, "Загальна", 50);
Client static_client(400, "Статичний", "Клієнт", "static@mail.com",
                     "+380555555555", 1000);
```

**Динамічні об'єкти через покажчики (рядки 250-252):**

```cpp
Publication* dyn_pub = new Publication(41, "Динамічне видання", ...);
Client* dyn_client = new Client(401, "Динамічний", "Клієнт", ...);
```

**Робота через покажчик (рядки 256-262):**

```cpp
cout << dyn_pub->GetPrice() << endl;  // Доступ через ->
dyn_pub->SetPrice(250);               // Виклик методу через ->
dyn_client->AddBalance(500);          // Виклик методу
```

**Масиви об'єктів (рядки 266-279):**

```cpp
Publication pub_array[3] = {
  Publication(50, "Журнал 1", ...),
  Publication(51, "Журнал 2", ...),
  Publication(52, "Журнал 3", ...)
};

Client client_array[2] = {
  Client(500, "Клієнт1", ...),
  Client(501, "Клієнт2", ...)
};
```

**Звільнення пам'яті (рядки 301-302):**

```cpp
delete dyn_pub;    // Викликається деструктор
delete dyn_client; // Викликається деструктор
```

---

### ✅ Пункт 7: Демонстрація всіх конструкторів

**Функція `DemonstrateConstructors()` (рядки 103-146 в main_lab3.cpp):**

1. **Без параметрів (рядки 113-114):**

   ```cpp
   Publication pub1;
   Client client1;
   ```

2. **З параметрами (рядки 118-119):**

   ```cpp
   Publication pub2(1, "Журнал програміста", "Про IT", 200.0, "IT", 100);
   Client client2(1, "Марія", "Коваленко", ...);
   ```

3. **Копіювання (рядки 123-124):**

   ```cpp
   Publication pub3 = pub2;  // Виклик конструктора копіювання
   Client client3 = client2;
   ```

4. **Зі списком ініціалізації (рядки 128-129):**
   ```cpp
   Publication pub4(2, "Швидке видання", 150.0);
   Client client4(2, "Олександр", "Сидоренко");
   ```

**Вивід на екран:**

- Кожен конструктор виводить повідомлення про створення об'єкта
- Відображається поточний лічильник (статичне поле)
- При знищенні викликаються деструктори з повідомленнями

---

### ✅ Пункт 8: Коментарі в коді

**Кожен пункт завдання позначено коментарями:**

- `Publication.h` рядок 12: `// Лаб 3, Пункт 3: Статичне поле даних`
- `publications.cpp` рядок 9: `// Лаб 3, Пункт 3: Ініціалізація статичного поля`
- `publications.cpp` рядок 10: `// Лаб 3, Пункт 1: Конструктор без параметрів`
- `publications.cpp` рядок 37: `// Лаб 3, Пункт 1: Конструктор копіювання`
- `publications.cpp` рядок 49: `// Лаб 3, Пункт 2: Конструктор зі списком ініціалізації`
- `main_lab3.cpp` рядок 15: `// Лаб 3, Пункт 4: Функція поза межами класу`
- `main_lab3.cpp` рядок 65: `// Лаб 3, Пункт 5: Функція типу класу`
- Аналогічно для всіх інших пунктів

---

### ✅ Пункт 9: UML-діаграма класів

**Структура класів:**

```
┌─────────────────────────────┐
│      Publication            │
├─────────────────────────────┤
│ - id_: int                  │
│ - title_: string            │
│ - description_: string      │
│ - price_: double            │
│ - category_: string         │
│ - rating_: double           │
│ - review_count_: int        │
│ - pages_: int               │
│ - static total_publications_count_: int │
├─────────────────────────────┤
│ + Publication()             │
│ + Publication(params)       │
│ + Publication(const Publication&) │
│ + ~Publication()            │
│ + SetPrice(double)          │
│ + AddRating(double)         │
│ + DisplayInfo()             │
│ + static GetTotalPublicationsCount() │
│ + static ResetPublicationsCount()    │
└─────────────────────────────┘
                △
                │
                │ uses
                │
┌─────────────────────────────┐
│         Client              │
├─────────────────────────────┤
│ - client_id_: int           │
│ - first_name_: string       │
│ - last_name_: string        │
│ - email_: string            │
│ - phone_: string            │
│ - is_blacklisted_: bool     │
│ - balance_: double          │
│ - subscription_months_: int │
│ - subscribed_publication_: Publication │
│ - static total_clients_count_: int     │
├─────────────────────────────┤
│ + Client()                  │
│ + Client(params)            │
│ + Client(const Client&)     │
│ + ~Client()                 │
│ + AddBalance(double)        │
│ + Subscribe(Publication&)   │
│ + DisplayInfo()             │
│ + static GetTotalClientsCount()    │
│ + static ResetClientsCount()       │
└─────────────────────────────┘
```

**Взаємозв'язки:**

- **Композиція**: Client містить об'єкт Publication (поле `subscribed_publication_`)
- **Використання**: Функції поза класом приймають об'єкти як параметри

---

### ✅ Пункт 10: Google C++ Style Guide

**Дотримання стандарту:**

1. **Імена класів**: `Publication`, `Client` (PascalCase)
2. **Імена методів**: `GetTitle()`, `AddBalance()` (PascalCase)
3. **Приватні поля**: `id_`, `title_`, `balance_` (trailing underscore)
4. **Статичні поля**: `total_publications_count_` (snake_case з underscore)
5. **Відступи**: 2 пробіли
6. **Include guards**: `#ifndef PUBLICATION_H_`
7. **Const correctness**: `const` параметри та методи
8. **Список ініціалізації**: Використовується в усіх конструкторах

---

### ✅ Пункт 11: Структура файлів

**Заголовні файли:**

- `Publication.h` - оголошення класу Publication
- `Client.h` - оголошення класу Client

**Файли реалізації:**

- `publications.cpp` - реалізація методів Publication
- `clients.cpp` - реалізація методів Client

**Демонстраційна програма:**

- `main_lab3.cpp` - демонстрація всіх пунктів завдання

**Допоміжні файли:**

- `Makefile` - для компіляції проекту
- `README_LAB3.md` - цей файл з документацією

---

## Компіляція та запуск

### Компіляція Лаб 3:

```bash
make              # Компіляція lab3_demo
make run          # Компіляція та запуск
```

### Компіляція Лаб 2:

```bash
make lab2_demo    # Компіляція lab2_demo
make run-lab2     # Запуск lab2_demo
```

### Компіляція обох:

```bash
make both         # Компілює lab2_demo і lab3_demo
```

### Очищення:

```bash
make clean        # Видаляє всі .o файли та виконувані файли
```

---

## Результати виконання

При запуску `./lab3_demo` програма демонструє:

1. ✅ **Конструктори**: Без параметрів, з параметрами, копіювання, зі списком ініціалізації
2. ✅ **Деструктори**: Автоматичне знищення об'єктів з виведенням повідомлень
3. ✅ **Статичні поля**: Спільний лічильник для всіх об'єктів класу
4. ✅ **Статичні методи**: Виклик без створення об'єктів
5. ✅ **Функції поза класом**: Обчислення з числовими даними
6. ✅ **Функції, що повертають об'єкти**: Створення нових об'єктів
7. ✅ **Покажчики**: Динамічне створення та видалення
8. ✅ **Масиви**: Статичні масиви об'єктів

---

## Особливості реалізації

### Конструктор копіювання

- **Глибоке копіювання** всіх полів
- Правильне копіювання вкладеного об'єкта `Publication` в `Client`
- Уникнення проблем з покажчиками

### Статичні елементи

- Лічильники автоматично оновлюються в конструкторах/деструкторах
- Статичні методи можуть бути викликані без об'єктів
- Спільне використання даних між усіма екземплярами класу

### Управління пам'яттю

- Коректне виділення через `new`
- Звільнення через `delete`
- Автоматичне знищення статичних об'єктів

### Списки ініціалізації

- Ефективна ініціалізація полів
- Можливість ініціалізації const полів та посилань
- Гарантований порядок ініціалізації

---

## Автор

Створено для виконання лабораторної роботи №3 з ООП

## Версія

- Лабораторна робота №2: Базова реалізація ООП
- Лабораторна робота №3: Конструктори, деструктори, статичні елементи (поточна версія)
